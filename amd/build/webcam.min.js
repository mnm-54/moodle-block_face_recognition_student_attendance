define ("block_face_recognition_student_attendance/webcam",["exports"],function(a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.default=void 0;function b(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(a){c(a);return}if(h.done){b(i)}else{Promise.resolve(i).then(d,e)}}function c(a){return function(){var c=this,d=arguments;return new Promise(function(e,f){var i=a.apply(c,d);function g(a){b(i,e,f,g,h,"next",a)}function h(a){b(i,e,f,g,h,"throw",a)}g(void 0)})}}function d(a){if("undefined"==typeof Symbol||null==a[Symbol.iterator]){if(Array.isArray(a)||(a=e(a))){var b=0,c=function(){};return{s:c,n:function n(){if(b>=a.length)return{done:!0};return{done:!1,value:a[b++]}},e:function e(a){throw a},f:c}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var d,f=!0,g=!1,h;return{s:function s(){d=a[Symbol.iterator]()},n:function n(){var a=d.next();f=a.done;return a},e:function e(a){g=!0;h=a},f:function f(){try{if(!f&&null!=d.return)d.return()}finally{if(g)throw h}}}}function e(a,b){if(!a)return;if("string"==typeof a)return f(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);if("Object"===c&&a.constructor)c=a.constructor.name;if("Map"===c||"Set"===c)return Array.from(c);if("Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c))return f(a,b)}function f(a,b){if(null==b||b>a.length)b=a.length;for(var c=0,d=Array(b);c<b;c++){d[c]=a[c]}return d}function g(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}function h(a,b){for(var c=0,d;c<b.length;c++){d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;if("value"in d)d.writable=!0;Object.defineProperty(a,d.key,d)}}function i(a,b,c){if(b)h(a.prototype,b);if(c)h(a,c);return a}var j=function(){function a(b){var c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"user",d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,e=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;g(this,a);this._webcamElement=b;this._webcamElement.width=this._webcamElement.width||640;this._webcamElement.height=this._webcamElement.height||this._webcamElement.width*(3/4);this._facingMode=c;this._webcamList=[];this._streamList=[];this._selectedDeviceId="";this._canvasElement=d;this._snapSoundElement=e}i(a,[{key:"getVideoInputs",value:function getVideoInputs(a){var b=this;this._webcamList=[];a.forEach(function(a){if("videoinput"===a.kind){b._webcamList.push(a)}});if(1==this._webcamList.length){this._facingMode="user"}return this._webcamList}},{key:"getMediaConstraints",value:function getMediaConstraints(){var a={};if(""==this._selectedDeviceId){a.facingMode=this._facingMode}else{a.deviceId={exact:this._selectedDeviceId}}return{video:a,audio:!1}}},{key:"selectCamera",value:function selectCamera(){var a=d(this._webcamList),b;try{for(a.s();!(b=a.n()).done;){var c=b.value;if("user"==this._facingMode&&c.label.toLowerCase().includes("front")||"enviroment"==this._facingMode&&c.label.toLowerCase().includes("back")){this._selectedDeviceId=c.deviceId;break}}}catch(b){a.e(b)}finally{a.f()}}},{key:"flip",value:function flip(){this._facingMode="user"==this._facingMode?"enviroment":"user";this._webcamElement.style.transform="";this.selectCamera()}},{key:"start",value:function(){var a=c(regeneratorRuntime.mark(function a(){var b=this,c,d=arguments;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:c=0<d.length&&d[0]!==void 0?d[0]:!0;return a.abrupt("return",new Promise(function(a,d){b.stop();navigator.mediaDevices.getUserMedia(b.getMediaConstraints()).then(function(e){b._streamList.push(e);b.info().then(function(e){b.selectCamera();window.console.log(e);if(c){b.stream().then(function(c){a(b._facingMode);window.console.log(c)}).catch(function(a){d(a)})}else{a(b._selectedDeviceId)}}).catch(function(a){d(a)})}).catch(function(a){d(a)})}));case 2:case"end":return a.stop();}}},a)}));return function start(){return a.apply(this,arguments)}}()},{key:"info",value:function(){var a=c(regeneratorRuntime.mark(function a(){var b=this;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(a,c){navigator.mediaDevices.enumerateDevices().then(function(c){b.getVideoInputs(c);a(b._webcamList)}).catch(function(a){c(a)})}));case 1:case"end":return a.stop();}}},a)}));return function info(){return a.apply(this,arguments)}}()},{key:"stream",value:function(){var a=c(regeneratorRuntime.mark(function a(){var b=this;return regeneratorRuntime.wrap(function(a){while(1){switch(a.prev=a.next){case 0:return a.abrupt("return",new Promise(function(a,c){navigator.mediaDevices.getUserMedia(b.getMediaConstraints()).then(function(c){b._streamList.push(c);b._webcamElement.srcObject=c;if("user"==b._facingMode){b._webcamElement.style.transform="scale(-1,1)"}b._webcamElement.play();a(b._facingMode)}).catch(function(a){window.console.log(a);c(a)})}));case 1:case"end":return a.stop();}}},a)}));return function stream(){return a.apply(this,arguments)}}()},{key:"stop",value:function stop(){this._streamList.forEach(function(a){a.getTracks().forEach(function(a){a.stop()})})}},{key:"snap",value:function snap(){if(null!==this._canvasElement){if(null!==this._snapSoundElement){this._snapSoundElement.play()}this._canvasElement.height=this._webcamElement.scrollHeight;this._canvasElement.width=this._webcamElement.scrollWidth;var a=this._canvasElement.getContext("2d");if("user"==this._facingMode){a.translate(this._canvasElement.width,0);a.scale(-1,1)}a.clearRect(0,0,this._canvasElement.width,this._canvasElement.height);a.drawImage(this._webcamElement,0,0,this._canvasElement.width,this._canvasElement.height);var b=this._canvasElement.toDataURL("image/png");return b}else{throw"canvas element is missing"}}},{key:"facingMode",get:function get(){return this._facingMode},set:function set(a){this._facingMode=a}},{key:"webcamList",get:function get(){return this._webcamList}},{key:"webcamCount",get:function get(){return this._webcamList.length}},{key:"selectedDeviceId",get:function get(){return this._selectedDeviceId}}]);return a}();a.default=j;return a.default});
//# sourceMappingURL=webcam.min.js.map
