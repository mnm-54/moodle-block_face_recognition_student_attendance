define ("block_face_recognition_student_attendance/attendance_modal",["exports","jquery","core/modal_factory","./webcam","core/ajax"],function(a,b,c,d,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=f(b);c=f(c);d=f(d);e=f(e);function f(a){return a&&a.__esModule?a:{default:a}}var g=function(a){window.console.log("we have been started");window.console.log(a);(0,b.default)(".action-modal").on("click",function(){var f="",g=(0,b.default)(this).attr("id");window.console.log(g);e.default.call([{methodname:"block_face_recognition_student_attendance_image_api",args:{courseid:g,studentid:a}}])[0].done(function(a){f=a.image_url}).fail(Notification.exception);c.default.create({type:c.default.types.SAVE_CANCEL,title:"Turn on webcam",body:"\n      <p>webcam will be turned on to take video and image input for your attendance</p>\n      <button id='start-webcam' class=\"btn btn-primary\">Start Webcam</button>\n      <button id='stop-webcam' class=\"btn btn-secondary\">Cancel</button>\n      <video id=\"webcam\" autoplay playsinline width=\"640\" height=\"480\"></video>\n      <img id=\"st-image\" style=\"display: none;\"/>\n      <canvas id=\"canvas\" class=\"d-none\"></canvas>"}).then(function(a){a.setSaveButtonText("Start Webcam");a.show();(0,b.default)(".modal-footer").hide();var c=document.getElementById("webcam"),e=document.getElementById("canvas"),g=document.getElementById("st-image");g.src=f;var h=e.getContext("2d");h.clearRect(0,0,g.width,g.height);h.drawImage(g,0,0,g.width,g.height);var i=e.toDataURL("image/png");window.console.log(i);var j=new d.default(c,"user",e);(0,b.default)("#start-webcam").on("click",function(){j.start().then(function(a){window.console.log("webcam started",a)}).catch(function(a){window.console.log(a)});setInterval(function(){j.snap()},1e3)});(0,b.default)("#stop-webcam").on("click",function(){j.stop();window.location.href=(0,b.default)(location).attr("href")})})})};a.init=g});
//# sourceMappingURL=attendance_modal.min.js.map
