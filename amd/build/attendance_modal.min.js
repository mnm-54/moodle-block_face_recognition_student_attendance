define ("block_face_recognition_student_attendance/attendance_modal",["exports","jquery","core/modal_factory","./webcam","core/ajax"],function(a,b,c,d,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=f(b);c=f(c);d=f(d);e=f(e);function f(a){return a&&a.__esModule?a:{default:a}}var g=function(a){(0,b.default)(".action-modal").on("click",function(){var f="",g=(0,b.default)(this).attr("id");e.default.call([{methodname:"block_face_recognition_student_attendance_image_api",args:{courseid:g,studentid:a}}])[0].done(function(a){f=a.image_url}).fail(Notification.exception);c.default.create({type:c.default.types.SAVE_CANCEL,title:"Turn on webcam",body:"\n      <p>webcam will be turned on to take video and image input for your attendance</p>\n      <button id='start-webcam' class=\"btn btn-primary\">Start Webcam</button>\n      <button id='stop-webcam' class=\"btn btn-secondary\">Cancel</button>\n      <video id=\"webcam\" autoplay playsinline width=\"300\" height=\"225\"></video>\n      <img id=\"st-image\" style=\"display: none;\"/>\n      <canvas id=\"canvas\" class=\"d-none\"></canvas>"}).then(function(a){a.setSaveButtonText("Start Webcam");a.show();(0,b.default)(".modal-footer").hide();var c=document.getElementById("webcam"),g=document.getElementById("canvas"),h=document.getElementById("st-image");h.src=f;var i="",j=new d.default(c,"user",g);(0,b.default)("#start-webcam").on("click",function(){j.start().then(function(a){window.console.log("webcam started",a)}).catch(function(a){window.console.log(a)});setTimeout(function(){if(!i){var c=g.getContext("2d");c.clearRect(0,0,h.width,h.height);c.drawImage(h,0,0,h.width,h.height);i=g.toDataURL("image/png")}var a=j.snap();window.console.log(a);window.console.log(i);var b={studentimg:f,webcampicture:a};e.default.call([{methodname:"block_face_recognition_student_attendance_face_recog_api",args:b}])[0].done(function(a){var b=a.confidence;window.console.log(b)}).fail(function(a){window.console.log(a)})},2e3)});(0,b.default)("#stop-webcam").on("click",function(){j.stop();window.location.href=(0,b.default)(location).attr("href")})})})};a.init=g});
//# sourceMappingURL=attendance_modal.min.js.map
